  {% load static %}
<html class="no-js" lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<title>Home two || Hurst</title>
		<meta name="description" content="Hurst – Furniture Store eCommerce HTML Template is a clean and elegant design – suitable for selling flower, cookery, accessories, fashion, high fashion, accessories, digital, kids, watches, jewelries, shoes, kids, furniture, sports….. It has a fully responsive width adjusts automatically to any screen size or resolution.">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
  <script src="https://khalti.com/static/khalti-checkout.js"></script>

    <link rel="shortcut icon" type="image/x-icon" href="{% static 'img/favicon.ico' %}">
		<!-- Place favicon.ico in the root directory -->
		
		<!-- Google Font -->
		<link href='https://fonts.googleapis.com/css?family=Lato:400,700,900' rel='stylesheet' type='text/css'>
		<link href='https://fonts.googleapis.com/css?family=Bree+Serif' rel='stylesheet' type='text/css'>

		<!-- all css here -->
		<!-- bootstrap v3.3.6 css -->
		<link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
		<!-- animate css -->
		<link rel="stylesheet" href="{% static 'css/animate.min.css' %}">
		<!-- jquery-ui.min css -->
		<link rel="stylesheet" href="{% static 'css/jquery-ui.min.css' %}">
		<!-- meanmenu css -->
		<link rel="stylesheet" href="{% static 'css/meanmenu.min.css' %}">
		<!-- nivo-slider css -->
		<link rel="stylesheet" href="{% static 'lib/css/nivo-slider.css' %}">
		<link rel="stylesheet" href="{% static 'lib/css/preview.css' %}">
		<!-- slick css -->
		<link rel="stylesheet" href="{% static 'css/slick.min.css' %}">
		<!-- lightbox css -->
		<link rel="stylesheet" href="{% static 'css/lightbox.min.css' %}">
		<!-- material-design-iconic-font css -->
		<link rel="stylesheet" href="{% static 'css/material-design-iconic-font.css' %}">
		<!-- All common css of theme -->
		<link rel="stylesheet" href="{% static 'css/default.css' %}">
		<!-- style css -->
		<link rel="stylesheet" href="{% static 'style.min.css' %}">
        <!-- shortcode css -->
        <link rel="stylesheet" href="{% static 'css/shortcode.css' %}">
		<!-- responsive css -->
		<link rel="stylesheet" href="{% static 'css/responsive.css' %}">
		<!-- modernizr css -->
		<script src="{% static 'js/vendor/modernizr-3.11.2.min.js' %}"></script>
    <!-- template styles -->
     	<!-- Font Awesome for Icons -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
		<link rel="stylesheet" href="{% static 'css/alert.css' %}">

		<!-- Alert System -->

    </head>
    <body>	
      <!-- WRAPPER START -->
<div class="wrapper bg-dark-white">

	<!-- HEADER AREA START -->
	<header id="sticky-menu" class="header header-2">
		<div class="header-area">
			<div class="container-fluid">
				<div class="row">
					
					<!-- Logo Center -->
					<div class="col-md-4 offset-md-4 col-7">
						<div class="logo text-md-center">
							<a href="{% url 'home' %}">
								<img src="{% static 'images/blooming.png' %}" width="100" height="100" alt="Blooming-Flower" />
							</a>
						</div>
					</div>

					<!-- Right Side: Cart + Login/Register -->
					<div class="col-md-4 col-12 text-end">
						<div class="d-flex justify-content-end align-items-center gap-3">
							
							<!-- Mini Cart Start -->
							<div class="mini-cart text-end">
    <ul>
        <li>
            <a class="cart-icon" href="#">
                <i class="zmdi zmdi-shopping-cart"></i>
                <span>{{ cart_item_count }}</span>
            </a>
            <div class="mini-cart-brief text-left">
                <div class="cart-items">
                    <p class="mb-0">You have <span>{{ cart_item_count }} items</span> in your shopping bag</p>
                </div>
                <div class="all-cart-product clearfix">
                    {% for item in cart_items %}
                    <div class="single-cart clearfix">
                        <div class="cart-photo">
                            <a href="#"><img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" style="width:90px;height:90px;object-fit:cover;" /></a>
                        </div>
                        <div class="cart-info">
                            <h5><a href="#">{{ item.product.name }}</a></h5>
                            <p class="mb-0">Price : Rs {{ item.product.price }}</p>
                            <p class="mb-0">Qty : {{ item.quantity }}</p>
                            <span class="cart-delete"><a href="#"><i class="zmdi zmdi-close"></i></a></span>
                        </div>
                    </div>
                    {% empty %}
                    <p class="text-center">Your cart is empty.</p>
                    {% endfor %}
                </div>
                <div class="cart-totals">
                    <h5 class="mb-0">Total <span class="floatright">Rs {{ cart_total }}</span></h5>
                </div>
                <div class="cart-bottom clearfix">
                    <a href="{% url 'cart' %}" class="button-one floatleft text-uppercase" data-text="View cart">View cart</a>
                    <a href="{% url 'checkout' %}" class="button-one floatright text-uppercase" data-text="Check out">Check out</a>
                </div>
            </div>
        </li>
    </ul>
</div>

							<!-- Mini Cart End -->

							<!-- Login/Register or Profile -->
							{% if request.user.is_authenticated %}
							<div class="dropdown">
								<a class="btn btn-sm btn-outline-primary dropdown-toggle" href="#" id="profileDropdown" data-bs-toggle="dropdown" aria-expanded="false">
									{{ request.user.username }}
								</a>
								<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
									<li><a class="dropdown-item" href="{% url 'user_profile' %}">My Profile</a></li>
									<li><a class="dropdown-item" href="{% url 'logout' %}">Logout</a></li>
								</ul>
							</div>
							{% else %}
							<a href="{% url 'register_login' %}">
								<button class="button-one submit-btn-4 text-uppercase" type="button" data-text="Login/Register" >
									Login/Register
								</button>
							</a>
							{% endif %}

						</div>
					</div>

				</div>
			</div>
		</div>
	</header>
	<!-- HEADER AREA END -->

</div>
<!-- WRAPPER END -->

<script>
document.addEventListener('DOMContentLoaded', function () {
	const addToCartLinks = document.querySelectorAll('a[data-add-to-cart]');
	addToCartLinks.forEach(link => {
		link.addEventListener('click', function (e) {
			e.preventDefault();
			const url = this.href;

			fetch(url)
				.then(response => response.json())
				.then(data => {
					// ✅ Update cart count
					const cartCountElement = document.querySelector('.cart-icon span');
					if (cartCountElement) {
						cartCountElement.textContent = data.cart_item_count;
					}
					location.reload();

					// ✅ Fetch updated mini cart content
					return fetch('/update-cart-mini/');
				})
				.then(response => response.json())
				.then(data => {
					const miniCart = document.querySelector('.mini-cart-brief');
					if (miniCart) {
						miniCart.innerHTML = data.mini_cart_html;
					}
				})
				.catch(error => {
					console.error("Failed to update cart:", error);
				});
		});
	});
});

</script>

				<!-- MAIN-MENU START -->
				<div class="menu-toggle menu-toggle-2 hamburger hamburger--emphatic d-none d-md-block">
					<div class="hamburger-box">
						<div class="hamburger-inner"></div>
					</div>
				</div>
				<div class="main-menu  d-none d-md-block">
					<nav>
						<ul>
							<li><a href="/">home</a></li>
							<li class="nav-item">
								<a class="nav-link" href="{% url 'product_list' %}" data-toggle="tab">Products</a>
							</li>
                            {% comment %} <li><a href="#">Shortcodes</a></li> {% endcomment %}
							{% comment %} <li><a href="shop-sidebar.html">accesories</a></li> {% endcomment %}
							{% comment %} <li><a href="shop-list.html">lookbook</a></li> {% endcomment %}
							<li><a href="{% url 'blog_list' %}">blog</a></li>
							{% comment %} <li><a href="#">pages</a></li> {% endcomment %}
							<li><a href="{% url 'aboutus' %}">about us</a></li>
							<li><a href="{% url 'contact' %}">contact</a></li>
							<li><a href="{% url 'wishlist' %}">Wishlist</a></li>
							<li><a href="{% url 'order_history' %}">Order History</a></li>

						</ul>
					</nav>
				</div>
				<!-- MAIN-MENU END -->
			</header>
			<!-- HEADER-AREA END -->
			<!-- Mobile-menu start -->
			<div class="mobile-menu-area">
				<div class="container-fluid">
					<div class="row">
						<div class="col-xs-12 d-block d-md-none">
							<div class="mobile-menu">
								<nav id="dropdown">
									<ul>
										<li><a href="index.html">home</a></li>
										<li><a href="shop.html">products</a></li>
										{% comment %} <li><a href="shop-sidebar.html">accesories</a></li>
										<li><a href="shop-list.html">lookbook</a></li> {% endcomment %}
										<li><a href="blog.html">blog</a></li>
										<li><a href="#">pages</a></li>
										<li><a href="about.html">about us</a></li>
										<li><a href="contact.html">contact</a></li>
									</ul>
								</nav>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id="toast-container"></div>

			<!-- Mobile-menu end -->
            {% block content %} {% endblock %}

<!-- FOOTER START -->
			<footer>
				<!-- Footer-area start -->
				<div class="footer-area footer-2">
					<div class="container">
						<div class="row">
							<div class="col-lg-4 col-md-6">
								<div class="single-footer">
									<h3 class="footer-title  title-border">Contact Us</h3>
									<ul class="footer-contact">
										<li><span>Address :</span> {{ contact.address|linebreaksbr }}</li>
										<li><span>Cell-Phone :</span> {{ contact.phone }}</li>
										<li><span>Email :</span> {{ contact.email }}</li>

									</ul>
								</div>
							</div>
							


							<div class="col-lg-2 col-md-3 col-sm-6">
								<div class="single-footer">
									<h3 class="footer-title  title-border">accounts</h3>
									<ul class="footer-menu">
										<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>My Account</a></li>
										{% comment %} <li><a href="#"><i class="zmdi zmdi-dot-circle"></i>My Wishlist</a></li> {% endcomment %}
										<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>My Cart</a></li>
										<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>Sign In</a></li>
										<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>Check out</a></li>
									</ul>
								</div>
							</div>
							<div class="col-lg-2 col-md-3 col-sm-6">
								<div class="single-footer">
									<h3 class="footer-title  title-border">shipping</h3>
									<ul class="footer-menu">
										<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>New Products</a></li>
										<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>Top Sellers</a></li>
										{% comment %} <li><a href="#"><i class="zmdi zmdi-dot-circle"></i>Manufactirers</a></li>
										<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>Suppliers</a></li>
										<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>Specials</a></li> {% endcomment %}
									</ul>
								</div>
							</div>
							<div class="col-lg-4 col-md-6">
								<div class="single-footer newsletter-item">
									<h3 class="footer-title  title-border">Email Newsletters</h3>
									<div class="footer-subscribe">
										<form action="#">
											<input type="text" name="email" placeholder="Email Address..." />
											<button class="button-one submit-btn-4" type="submit" data-text="Subscribe">Subscribe</button>
										</form>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- Footer-area end -->
				<!-- Copyright-area start -->
				<div class="copyright-area copyright-2">
					<div class="container">
						<div class="row">
							<div class="col-md-6">
								<div class="copyright">
									<p class="mb-0">&copy; <a href="https://themeforest.net/user/codecarnival/portfolio" target="_blank">CodeCarnival </a> 2022. All Rights Reserved.</p>
								</div>
							</div>
							<div class="col-md-6">
								<div class="payment  text-md-end">
									<a href="#"><img src="{% static 'img/payment/1.png' %}" alt="" /></a>
									<a href="#"><img src="{% static 'img/payment/2.png' %}" alt="" /></a>
									<a href="#"><img src="{% static 'img/payment/3.png' %}" alt="" /></a>
									<a href="#"><img src="{% static 'img/payment/4.png' %}" alt="" /></a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- Copyright-area start -->

			</footer>
			<!-- FOOTER END -->
			<!-- QUICKVIEW PRODUCT MODAL -->
		<div id="quickview-wrapper">
  <div class="modal fade" id="productModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Product Quick View</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
          {% if product_detail %}
          <div class="row">

            <!-- Left: Product Image -->
            <div class="col-md-5 text-center">
              <div class="product-images">
                <img src="{{ product_detail.image.url }}" alt="{{ product_detail.name }}" class="img-fluid"
                  style="width: 100%; max-width: 350px; height: 450px; object-fit: cover;" />
              </div>
            </div>

            <!-- Right: Product Info -->
            <div class="col-md-7">
              <div class="product-info">
                <h2>{{ product_detail.name }}</h2>

                <!-- Price Section -->
                <div class="price-box-3">
                  <hr />
                  <div class="s-price-box">
                    <span class="new-price fw-bold text-success fs-5">Rs {{ product_detail.price }}</span>
                    {% if product_detail.old_price %}
                    <span class="old-price text-muted ms-3 text-decoration-line-through">Rs {{ product_detail.old_price }}</span>
                    {% endif %}
                  </div>
                  <hr />
                </div>

                <!-- Quantity and Add to Cart -->
                <div class="quick-add-to-cart mb-3">
                  <form method="post" class="cart">
                    {% csrf_token %}
                    <div class="input-group" style="max-width: 150px;">
                      <input type="number" name="quantity" id="quantity" value="1" min="1" class="form-control" />
                      <button class="btn btn-primary" type="submit">Add to Cart</button>
                    </div>
                  </form>
                </div>

                <!-- Description -->
                <div class="quick-desc mb-3">
                  <h6>Description:</h6>
                  <p>{{ product_detail.description }}</p>
                </div>

                <!-- Order Detail Section (Added) -->
                <div class="order-detail-section mb-3">
                  <h6>Order Details:</h6>
                  <ul class="list-unstyled ms-2">
                    <li><i class="zmdi zmdi-calendar-note"></i> Stock: {{ product_detail.stock }}</li>
                    <li><i class="zmdi zmdi-balance-wallet"></i> Category: {{ product_detail.category.name }}</li>
                    <li><i class="zmdi zmdi-truck"></i> Delivery: 2-4 working days</li>
                  </ul>
                </div>

                <!-- Social Sharing -->
                <div class="social-sharing mb-3">
                  <h6>Share this product:</h6>
                  <ul class="list-inline">
                    <li class="list-inline-item"><a href="#" title="Google +"><i class="zmdi zmdi-google-plus"></i></a></li>
                    <li class="list-inline-item"><a href="#" title="Twitter"><i class="zmdi zmdi-twitter"></i></a></li>
                    <li class="list-inline-item"><a href="#" title="Facebook"><i class="zmdi zmdi-facebook"></i></a></li>
                    <li class="list-inline-item"><a href="#" title="LinkedIn"><i class="zmdi zmdi-linkedin"></i></a></li>
                  </ul>
                </div>

                <!-- Review Section -->
                {% if request.user.is_authenticated %}
                <hr />
                <div class="review-section">
                  <h5>Rate this Product</h5>
                  <form method="post" action="{% url 'rate_product' product_detail.id %}">
                    {% csrf_token %}
                    <div class="mb-3">
                      <label class="form-label d-block">Your Rating:</label>
                      <div class="star-rating" style="font-size: 28px; cursor: pointer;">
                        {% for i in "12345" %}
                        <i class="zmdi zmdi-star-outline star" data-value="{{ forloop.counter }}" style="color: #ddd;"></i>
                        {% endfor %}
                      </div>
                      <input type="hidden" name="rating" id="rating-input" value="0" required />
                    </div>
                    <div class="mb-3">
                      <label class="form-label">Comment:</label>
                      <textarea name="comment" class="form-control" rows="3" placeholder="Write your thoughts..."></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Review</button>
                  </form>
                </div>
                {% else %}
                <div class="alert alert-warning mt-3">
                  Please <a href="{% url 'login' %}?next={{ request.path }}">login</a> to rate and review.
                </div>
                {% endif %}

              </div>
            </div>
          </div>
          {% else %}
          <p>Product details not available.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const modal = document.getElementById("productModal");

  modal.addEventListener("shown.bs.modal", function () {
    const stars = modal.querySelectorAll(".star-rating .star");
    const ratingInput = modal.querySelector("#rating-input");

    if (!stars || !ratingInput) return;

    stars.forEach((star) => {
      star.addEventListener("click", function () {
        const rating = parseInt(this.getAttribute("data-value"));
        ratingInput.value = rating;

        stars.forEach((s) => {
          s.classList.remove("zmdi-star");
          s.classList.add("zmdi-star-outline");
        });

        stars.forEach((s) => {
          if (parseInt(s.getAttribute("data-value")) <= rating) {
            s.classList.remove("zmdi-star-outline");
            s.classList.add("zmdi-star");
          }
        });
      });
    });
  });
});
</script>


{% if product_detail %}
<script>
  document.addEventListener("DOMContentLoaded", function() {
    var myModal = new bootstrap.Modal(document.getElementById('productModal'));
    myModal.show();
  });
</script>
{% endif %}


{% if product_detail %}
<script>
  document.addEventListener("DOMContentLoaded", function() {
    var myModal = new bootstrap.Modal(document.getElementById('productModal'));
    myModal.show();
  });
</script>
{% endif %}

	</body>
</html>
  <script src="{% static 'js/vendor/jquery-3.6.0.min.js' %}"></script>
		<script src="{% static 'js/vendor/jquery-migrate-3.3.2.min.js' %}"></script>
		<!-- bootstrap js -->
		<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
		<!-- jquery.meanmenu js -->
		<script src="{% static 'js/jquery.meanmenu.js' %}"></script>
		<!-- slick.min js -->
		<script src="{% static 'js/slick.min.js' %}"></script>
		<!-- jquery.treeview js -->
		<script src="{% static 'js/jquery.treeview.js' %}"></script>
		<!-- lightbox.min js -->
		<script src="{% static 'js/lightbox.min.js' %}"></script>
		<!-- jquery-ui js -->
		<script src="{% static 'js/jquery-ui.min.js' %}"></script>
		<!-- jquery.nivo.slider js -->
		<script src="{% static 'lib/js/jquery.nivo.slider.js' %}"></script>
		<script src="{% static 'lib/home.js' %}"></script>
		<!-- jquery.nicescroll.min js -->
		<script src="{% static 'js/jquery.nicescroll.min.js' %}"></script>
		<!-- countdon.min js -->
		<script src="{% static 'js/countdon.min.js' %}"></script>
		<!-- wow js -->
		<script src="{% static 'js/wow.min.js' %}"></script>
		<!-- plugins js -->
		<script src="{% static 'js/plugins.js' %}"></script>
		<!-- main js -->
		<script src="{% static 'js/main.min.js' %}"></script>
		<script src="{% static 'js/alert-system.js' %}"></script>

